<h2 class="section-title">Architecture & Design Patterns</h2>


<div class="learning-objectives">
  <h3>Learning Objectives</h3>
  <ul>
    <li>Understand MCP's client-server architecture</li>
    <li>Learn about transport protocols and message formats</li>
    <li>Explore security and authentication patterns</li>
  </ul>
</div>

<h3>Client-Server Model</h3>
<p>MCP follows a client-server architecture where AI assistants (clients) connect to MCP servers that provide
  resources and tools. Communication is bidirectional and follows a request-response pattern with optional
  streaming capabilities.</p>

<div class="diagram-container">
  <h4>MCP Communication Flow</h4>
  <svg class="mcp-diagram" viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg">
    <!-- Background -->
    <rect width="800" height="500" fill="#ffffff" rx="10" />
    
    <!-- MCP Client -->
    <g class="mcp-client">
      <rect x="80" y="150" width="160" height="120" rx="10" fill="#667eea" stroke="#5a67d8" stroke-width="2" class="client-box"/>
      <text x="160" y="185" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="16" font-weight="bold">MCP CLIENT</text>
      <text x="160" y="205" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12">(AI Assistant)</text>
      <text x="160" y="225" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10">Claude, ChatGPT, etc.</text>
      <circle cx="220" cy="165" r="5" fill="#4ade80" class="client-status"/>
    </g>

    <!-- MCP Server -->
    <g class="mcp-server">
      <rect x="560" y="150" width="160" height="120" rx="10" fill="#48bb78" stroke="#38a169" stroke-width="2" class="server-box"/>
      <text x="640" y="185" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="16" font-weight="bold">MCP SERVER</text>
      <text x="640" y="205" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12">(Resource Provider)</text>
      <text x="640" y="225" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10">Files, APIs, Databases</text>
      <circle cx="580" cy="165" r="5" fill="#4ade80" class="server-status"/>
    </g>

    <!-- Communication Lines -->
    <g class="communication-lines">
      <!-- Request line -->
      <line x1="240" y1="195" x2="560" y2="195" stroke="#667eea" stroke-width="3" class="request-line" opacity="0"/>
      
      <!-- Response line -->
      <line x1="560" y1="225" x2="240" y2="225" stroke="#48bb78" stroke-width="3" class="response-line" opacity="0"/>
    </g>

    <!-- Message Dots -->
    <g class="message-dots">
      <circle cx="240" cy="195" r="6" fill="#667eea" class="request-dot" opacity="0"/>
      <circle cx="560" cy="225" r="6" fill="#48bb78" class="response-dot" opacity="0"/>
    </g>

    <!-- Step Information -->
    <g class="step-info">
      <!-- Step 1 -->
      <rect x="300" y="80" width="200" height="30" rx="5" fill="#8b5cf6" opacity="0" class="step-box step-1"/>
      <text x="400" y="100" text-anchor="middle" fill="white" font-size="14" font-weight="bold" class="step-text step-1" opacity="0">1. Initialize Connection</text>
      
      <!-- Step 2 -->
      <rect x="300" y="120" width="200" height="30" rx="5" fill="#667eea" opacity="0" class="step-box step-2"/>
      <text x="400" y="140" text-anchor="middle" fill="white" font-size="14" font-weight="bold" class="step-text step-2" opacity="0">2. Get Tools List</text>
      
      <!-- Step 3 -->
      <rect x="300" y="320" width="200" height="30" rx="5" fill="#9f7aea" opacity="0" class="step-box step-3"/>
      <text x="400" y="340" text-anchor="middle" fill="white" font-size="14" font-weight="bold" class="step-text step-3" opacity="0">3. Get Resource</text>
      
      <!-- Step 4 -->
      <rect x="300" y="360" width="200" height="30" rx="5" fill="#ed8936" opacity="0" class="step-box step-4"/>
      <text x="400" y="380" text-anchor="middle" fill="white" font-size="14" font-weight="bold" class="step-text step-4" opacity="0">4. Call Action</text>
    </g>

    <!-- Message Details -->
    <g class="message-details">
      <!-- Request details -->
      <text x="400" y="180" text-anchor="middle" fill="#667eea" font-size="12" class="request-details" opacity="0">
        JSON-RPC Request →
      </text>
      
      <!-- Response details -->
      <text x="400" y="245" text-anchor="middle" fill="#48bb78" font-size="12" class="response-details" opacity="0">
        ← JSON-RPC Response
      </text>
    </g>

    <!-- JSON Examples -->
    <g class="json-examples">
      <!-- Initialize example -->
      <text x="400" y="30" text-anchor="middle" fill="#8b5cf6" font-size="10" class="json-init" opacity="0">
        {"jsonrpc": "2.0", "method": "initialize", "params": {...}}
      </text>
      
      <!-- Tools list example -->
      <text x="400" y="45" text-anchor="middle" fill="#667eea" font-size="10" class="json-tools" opacity="0">
        {"jsonrpc": "2.0", "method": "tools/list", "params": {}}
      </text>
      
      <!-- Resource example -->
      <text x="400" y="420" text-anchor="middle" fill="#9f7aea" font-size="10" class="json-resource" opacity="0">
        {"jsonrpc": "2.0", "method": "resources/read", "params": {"uri": "..."}}
      </text>
      
      <!-- Action example -->
      <text x="400" y="435" text-anchor="middle" fill="#ed8936" font-size="10" class="json-action" opacity="0">
        {"jsonrpc": "2.0", "method": "tools/call", "params": {"name": "..."}}
      </text>
    </g>
  </svg>

  <div class="diagram-controls">
    <button class="diagram-btn" id="toggleAnimation">▶ Play Animation</button>
    <button class="diagram-btn" id="resetAnimation">↻ Reset</button>
  </div>
</div>

<div class="highlight-box">
  <h3>Transport Protocols</h3>
  <p><strong>HTTP/HTTPS:</strong> Standard web protocols for RESTful interactions</p>
  <p><strong>WebSocket:</strong> Real-time bidirectional communication</p>
  <p><strong>stdio:</strong> Standard input/output for local process communication</p>
</div>

<h3>Message Format</h3>
<p>MCP uses JSON-RPC 2.0 as its message format, providing a standardized way to encode requests, responses, and
  notifications.</p>

<div class="code-block">
  <div class="ace-editor" id="editor2">{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "resources/list",
  "params": {
    "cursor": null
  }
}

// Response
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "resources": [
      {
        "uri": "file://documents/readme.txt",
        "name": "README",
        "mimeType": "text/plain"
      }
    ]
  }
}
  </div>
</div>

<h3>Security Considerations</h3>
<ul>
  <li><strong>Authentication:</strong> API keys, OAuth 2.0, or custom auth schemes</li>
  <li><strong>Authorization:</strong> Resource-level and operation-level permissions</li>
  <li><strong>Encryption:</strong> TLS for transport security</li>
  <li><strong>Rate Limiting:</strong> Prevent abuse and ensure fair usage</li>
</ul>

<button class="btn" onclick="markSectionComplete('architecture')">Mark Complete</button>